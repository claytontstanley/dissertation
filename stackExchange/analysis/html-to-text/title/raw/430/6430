How to programmatically iterate datagrid rows?