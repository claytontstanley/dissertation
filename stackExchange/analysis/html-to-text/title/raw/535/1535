Reducing duplicate error handling code in C#?