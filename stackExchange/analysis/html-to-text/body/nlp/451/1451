i
often
encounter
the
following
scenario
where
i
need
to
offer
many
different
type
of
permission
.
i
primarily
use
asp.net
/
vb.net
with
sql
server
2000
.
scenario
i
want
to
offer
a
dynamic
permission
system
that
can
work
on
different
parameter
.
let
's
say
that
i
want
to
give
either
a
department
or
just
a
specific
person
access
to
an
application
.
and
pretend
that
we
have
a
number
of
application
that
keep
growing
.
in
the
past
,
i
have
chosen
one
of
the
following
two
way
that
i
know
to
do
this
.
use
a
single
permission
table
with
special
column
that
are
used
for
determining
a
how
to
apply
the
parameter
.
the
special
column
in
this
example
are
typeid
and
typeauxid
.
the
sql
would
look
something
like
this
.
select
count
(
permissionid
)
from
application_permissions
where
(
typeid
=
1
and
typeauxid
=
@
userid
)
or
(
typeid
=
2
and
typeauxid
=
@
departmentid
)
and
applicationid
=
1
use
a
mapping
table
for
each
type
of
permission
,
then
joining
them
all
together
.
select
count
(
perm.permissionid
)
from
application_permissions
perm
left
join
application_userpermissions
emp
on
perm.applicationid
=
emp.applicationid
left
join
application_departmentpermissions
dept
on
perm.applicationid
=
dept.applicationid
where
q.sectionid=
@
sectionid
and
(
emp.userid=
@
userid
or
dept.deptid=
@
deptid
or
(
emp.userid
is
null
and
dept.deptid
is
null
)
)
and
applicationid
=
1
order
by
q.qid
asc
my
thoughts
i
hope
that
the
example
make
sense
.
i
cobbled
them
together
.
the
first
example
requires
le
work
,
but
neither
of
them
feel
like
the
best
answer
.
is
there
a
better
way
to
handle
this
?