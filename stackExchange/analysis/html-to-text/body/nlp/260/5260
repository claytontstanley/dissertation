i
have
a
situation
where
i
want
to
add
hour
to
a
date
and
have
the
new
date
wrap
around
the
work-day
.
i
cobbled
up
a
function
to
determine
this
new
date
,
but
want
to
make
sure
that
i
'm
not
forgetting
anything
.
the
hour
to
be
added
is
called
``
delay
''
.
it
could
easily
be
a
parameter
to
the
function
instead
.
please
post
any
suggestion
.
[
vb.net
warning
]
private
function
getdaterequired
(
)
as
date
''//
a
decimal
representation
of
the
current
hour
dim
hour
as
decimal
=
decimal.parse
(
date.now.hour
)
+
(
decimal.parse
(
date.now.minute
)
/
60.0
)
dim
delay
as
decimal
=
3.0
''//
delay
in
hour
dim
endofday
as
decimal
=
12.0
+
5.0
''//
end
of
day
,
in
hour
dim
startofday
as
decimal
=
8.0
''//
start
of
day
,
in
hour
dim
newhour
as
integer
dim
newminute
as
integer
dim
daterequired
as
date
=
now
dim
delta
as
decimal
=
hour
+
delay
''//
wrap
around
to
the
next
day
,
if
necessary
if
delta
>
endofday
then
delta
=
delta
-
endofday
daterequired
=
daterequired.adddays
(
1
)
newhour
=
integer.parse
(
decimal.truncate
(
delta
)
)
newminute
=
integer.parse
(
decimal.truncate
(
(
delta
-
newhour
)
*
60
)
)
newhour
=
startofday
+
newhour
else
newhour
=
integer.parse
(
decimal.truncate
(
delta
)
)
newminute
=
integer.parse
(
decimal.truncate
(
(
delta
-
newhour
)
*
60
)
)
end
if
daterequired
=
new
date
(
daterequired.year
,
daterequired.month
,
daterequired.day
,
newhour
,
newminute
,
0
)
return
daterequired
end
sub
note
:
this
will
probably
not
work
if
delay
is
more
than
9
hour
long
.
it
should
never
change
from
3
,
through
.
edit
:
the
goal
is
find
the
date
and
time
that
you
get
a
a
result
of
adding
several
hour
to
the
current
time
.
this
is
used
to
determine
a
default
value
for
a
due
date
of
a
submission
.
i
want
to
add
3
hour
to
the
current
time
to
get
the
due
date
time
.
however
,
i
do
n't
want
due
date
that
go
beyond
5pm
on
the
current
day
.
so
,
i
tried
to
have
the
hour
split
between
(
today
,
up
to
5pm
)
and
(
tomorrow
,
from
8am
on
)
,
such
that
adding
3
hour
to
4pm
would
give
you
19am
,
because
1
hour
is
added
to
the
end
of
today
and
2
hour
are
added
to
the
beginning
of
tomorrow
.