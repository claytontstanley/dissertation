i
want
to
print
html
from
a
c
#
web
service.
the
web
browser
control
is
overkill
,
and
doe
not
function
well
in
a
service-environment
,
nor
doe
it
function
well
on
a
system
with
very
tight
security
constraints.
is
there
any
sort
of
free
.net
library
that
will
support
the
printing
of
a
basic
html
page
?
here
is
the
code
i
have
so
far
,
that
is
not
running
properly.
public
void
printthing
(
string
document
)
{
if
(
thread.currentthread.getapartmentstate
(
)
!
=
apartmentstate.sta
)
{
thread
thread
=
new
thread
(
(
threadstart
)
delegate
{
printdocument
(
document
)
;
}
)
;
thread.setapartmentstate
(
apartmentstate.sta
)
;
thread.start
(
)
;
}
else
{
printdocument
(
document
)
;
}
}
protected
void
printdocument
(
string
document
)
{
webbrowser
browser
=
new
webbrowser
(
)
;
browser.documenttext
=
document
;
while
(
browser.readystate
!
=
webbrowserreadystate.complete
)
{
application.doevents
(
)
;
}
browser.print
(
)
;
}
this
work
fine
when
called
from
ui-type
thread
,
but
nothing
happens
when
called
from
a
service-type
thread.
changing
print
(
)
to
showprintpreviewdialog
(
)
yield
the
following
ie
script
error
:
error
:
'dialogarguments.___ie_printtype
'
is
null
or
not
an
object
url
:
re
:
//ieframe.dll/preview.dlg
and
a
small
empty
print
preview
dialog
appears
.