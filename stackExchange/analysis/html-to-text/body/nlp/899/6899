to
illustrate
,
assume
that
i
have
two
table
a
follows
:
vehicleid
name
1
chuck
2
larry
locationid
vehicleid
city
1
1
new
york
2
1
seattle
3
1
vancouver
4
2
los
angeles
5
2
houston
i
want
to
write
a
query
to
return
the
following
result
:
vehicleid
name
locations
1
chuck
new
york
,
seattle
,
vancouver
2
larry
los
angeles
,
houston
i
know
that
this
can
be
done
using
server
side
cursor
,
ie
:
declare
@
vehicleid
int
declare
@
vehiclename
varchar
(
100
)
declare
@
locationcity
varchar
(
100
)
declare
@
locations
varchar
(
4000
)
declare
@
results
table
(
vehicleid
int
name
varchar
(
100
)
locations
varchar
(
4000
)
)
declare
vehiclescursor
cursor
for
select
[
vehicleid
]
,
[
name
]
from
[
vehicles
]
open
vehiclescursor
fetch
next
from
vehiclescursor
into
@
vehicleid
,
@
vehiclename
while
@
@
fetch_status
=
0
begin
set
@
locations
=
''
declare
locationscursor
cursor
for
select
[
city
]
from
[
locations
]
where
[
vehicleid
]
=
@
vehicleid
open
locationscursor
fetch
next
from
locationscursor
into
@
locationcity
while
@
@
fetch_status
=
0
begin
set
@
locations
=
@
locations
+
@
locationcity
fetch
next
from
locationscursor
into
@
locationcity
end
close
locationscursor
deallocate
locationscursor
insert
into
@
results
(
vehicleid
,
name
,
locations
)
select
@
vehicleid
,
@
name
,
@
locations
end
close
vehiclescursor
deallocate
vehiclescursor
select
*
from
@
results
however
,
a
you
can
see
,
this
requires
a
great
deal
of
code.
what
i
would
like
is
a
generic
function
that
would
allow
me
to
do
something
like
this
:
select
vehicleid
,
name
,
join
(
select
city
from
locations
where
vehicleid
=
vehicles.vehicleid
,
'
,
'
)
as
locations
from
vehicles
is
this
possible
?
or
something
similar
?