recently
our
site
ha
been
deluged
with
the
resurgence
of
the
asprox
bot
sql
injection
attack.
without
going
into
detail
,
the
attack
attempt
to
execute
sql
code
by
encoding
the
t-sql
command
in
an
ascii
encoded
binary
string.
it
look
something
like
this
:
declare
%
20
@
s
%
20nvarchar
(
4000
)
;
set
%
20
@
s=cast
(
0x44004500
...
06f007200
%
20as
%
20nvarchar
(
4000
)
)
;
exec
(
@
s
)
;
--
i
wa
able
to
decode
this
in
sql
,
but
i
wa
a
little
wary
of
doing
this
since
i
did
n't
know
exactly
what
wa
happening
at
the
time.
i
tried
to
write
a
simple
decode
tool
so
i
could
decode
this
type
of
text
without
even
touching
sql
server.
the
main
part
i
need
decoded
is
:
cast
(
0x44004500
...
06f007200
as
nvarchar
(
4000
)
)
i
've
tried
all
of
the
following
command
with
no
luck
:
txtdecodedtext.text
=
system.web.httputility.urldecode
(
txturltext.text
)
;
txtdecodedtext.text
=
encoding.ascii.getstring
(
encoding.ascii.getbytes
(
txturltext.text
)
)
;
txtdecodedtext.text
=
encoding.unicode.getstring
(
encoding.unicode.getbytes
(
txturltext.text
)
)
;
txtdecodedtext.text
=
encoding.ascii.getstring
(
encoding.unicode.getbytes
(
txturltext.text
)
)
;
txtdecodedtext.text
=
encoding.unicode.getstring
(
convert.frombase64string
(
txturltext.text
)
)
;
can
anybody
suggest
the
proper
way
to
translate
this
encoding
without
using
sql
server.
is
is
possible
?
i
'll
take
vb.net
code
since
i
'm
familiar
with
that
too
.